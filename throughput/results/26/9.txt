BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%saddle%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264716055.530608
 ALGERIA                   |   1997 | 458250176.199165
 ALGERIA                   |   1996 |  464890050.97735
 ALGERIA                   |   1995 |  464794991.12997
 ALGERIA                   |   1994 | 466649330.914609
 ALGERIA                   |   1993 | 463545707.704741
 ALGERIA                   |   1992 |  462853130.99714
 ARGENTINA                 |   1998 | 278611298.751349
 ARGENTINA                 |   1997 | 469297944.862164
 ARGENTINA                 |   1996 | 467369196.226358
 ARGENTINA                 |   1995 | 468004965.677205
 ARGENTINA                 |   1994 | 471429829.931947
 ARGENTINA                 |   1993 | 468506164.815917
 ARGENTINA                 |   1992 | 462618462.866477
 BRAZIL                    |   1998 | 277024827.084991
 BRAZIL                    |   1997 | 472401125.889903
 BRAZIL                    |   1996 | 471799497.118723
 BRAZIL                    |   1995 | 467243044.228376
 BRAZIL                    |   1994 | 465795734.132648
 BRAZIL                    |   1993 | 469422908.924985
 BRAZIL                    |   1992 | 469071334.823421
 CANADA                    |   1998 | 272365082.805988
 CANADA                    |   1997 |  474174382.37815
 CANADA                    |   1996 | 475230783.636943
 CANADA                    |   1995 | 480954546.445942
 CANADA                    |   1994 | 475230484.930233
 CANADA                    |   1993 | 485406165.039517
 CANADA                    |   1992 | 479379436.182306
 CHINA                     |   1998 | 274064648.088569
 CHINA                     |   1997 |  466210926.24116
 CHINA                     |   1996 |  462105240.27651
 CHINA                     |   1995 | 468385716.867677
 CHINA                     |   1994 | 464866987.617112
 CHINA                     |   1993 | 464441347.661255
 CHINA                     |   1992 | 467729433.599401
 EGYPT                     |   1998 | 268601084.252934
 EGYPT                     |   1997 | 456004674.031474
 EGYPT                     |   1996 | 458509106.997655
 EGYPT                     |   1995 | 458058584.331051
 EGYPT                     |   1994 | 453672302.302528
 EGYPT                     |   1993 | 466647391.604492
 EGYPT                     |   1992 | 447231369.819354
 ETHIOPIA                  |   1998 | 271327303.589553
 ETHIOPIA                  |   1997 | 466164787.071847
 ETHIOPIA                  |   1996 | 462927351.785104
 ETHIOPIA                  |   1995 | 457938344.428785
 ETHIOPIA                  |   1994 | 464905988.780876
 ETHIOPIA                  |   1993 | 462668959.523054
 ETHIOPIA                  |   1992 | 469284749.052785
 FRANCE                    |   1998 |  267321045.42073
 FRANCE                    |   1997 | 456475010.862109
 FRANCE                    |   1996 | 455097867.849947
 FRANCE                    |   1995 | 461442317.874492
 FRANCE                    |   1994 | 468588771.018292
 FRANCE                    |   1993 | 460036685.099075
 FRANCE                    |   1992 | 461619979.859147
 GERMANY                   |   1998 |  277165099.61395
 GERMANY                   |   1997 | 481127333.168508
 GERMANY                   |   1996 | 480928993.256485
 GERMANY                   |   1995 | 479483304.775743
 GERMANY                   |   1994 |  479150787.46094
 GERMANY                   |   1993 | 483585405.239056
 GERMANY                   |   1992 |  480000732.73474
 INDIA                     |   1998 | 276132742.608091
 INDIA                     |   1997 | 475920479.016546
 INDIA                     |   1996 | 474448524.957461
 INDIA                     |   1995 | 481049502.371291
 INDIA                     |   1994 | 486744339.387415
 INDIA                     |   1993 | 473406285.962147
 INDIA                     |   1992 | 477129342.701893
 INDONESIA                 |   1998 | 269672691.638876
 INDONESIA                 |   1997 | 466000085.329973
 INDONESIA                 |   1996 | 470692154.294278
 INDONESIA                 |   1995 | 466047026.962881
 INDONESIA                 |   1994 | 473620359.138961
 INDONESIA                 |   1993 | 466858632.684727
 INDONESIA                 |   1992 | 468870380.149025
 IRAN                      |   1998 | 263734668.223558
 IRAN                      |   1997 | 456076162.950269
 IRAN                      |   1996 | 458513297.923781
 IRAN                      |   1995 | 458858437.653393
 IRAN                      |   1994 | 451690958.118156
 IRAN                      |   1993 | 453615537.266661
 IRAN                      |   1992 |  460073724.44989
 IRAQ                      |   1998 |    280667766.612
 IRAQ                      |   1997 | 467619879.802195
 IRAQ                      |   1996 | 471282083.948862
 IRAQ                      |   1995 | 466862288.793457
 IRAQ                      |   1994 |  477285105.53857
 IRAQ                      |   1993 | 471928681.333087
 IRAQ                      |   1992 | 477407650.216378
 JAPAN                     |   1998 | 265156380.875802
 JAPAN                     |   1997 | 465237983.434605
 JAPAN                     |   1996 | 463800955.611983
 JAPAN                     |   1995 | 459858908.768049
 JAPAN                     |   1994 | 462139444.169959
 JAPAN                     |   1993 | 464555969.186334
 JAPAN                     |   1992 | 466458344.591683
 JORDAN                    |   1998 | 273056786.575368
 JORDAN                    |   1997 | 460251207.235148
 JORDAN                    |   1996 | 466303587.903952
 JORDAN                    |   1995 | 460841274.107147
 JORDAN                    |   1994 | 466371672.545764
 JORDAN                    |   1993 | 461320858.820796
 JORDAN                    |   1992 | 460045264.461902
 KENYA                     |   1998 |   268193236.5312
 KENYA                     |   1997 | 463188726.584206
 KENYA                     |   1996 | 468747318.375257
 KENYA                     |   1995 | 470066670.734442
 KENYA                     |   1994 | 462243087.447075
 KENYA                     |   1993 | 468902738.117995
 KENYA                     |   1992 | 473671911.575732
 MOROCCO                   |   1998 | 271922967.336327
 MOROCCO                   |   1997 | 471789556.247316
 MOROCCO                   |   1996 | 466000693.890046
 MOROCCO                   |   1995 | 470800664.825315
 MOROCCO                   |   1994 | 465754181.970656
 MOROCCO                   |   1993 | 470848560.254949
 MOROCCO                   |   1992 | 477440654.171229
 MOZAMBIQUE                |   1998 |  272413603.91851
 MOZAMBIQUE                |   1997 | 462731641.784083
 MOZAMBIQUE                |   1996 | 467458348.099431
 MOZAMBIQUE                |   1995 | 459091632.985085
 MOZAMBIQUE                |   1994 | 464687544.686739
 MOZAMBIQUE                |   1993 | 457612090.429837
 MOZAMBIQUE                |   1992 | 454670087.009608
 PERU                      |   1998 | 277993239.971502
 PERU                      |   1997 | 469700383.157928
 PERU                      |   1996 | 468910881.276745
 PERU                      |   1995 | 467628703.058887
 PERU                      |   1994 | 462840256.546791
 PERU                      |   1993 | 467090854.863703
 PERU                      |   1992 | 464412941.067931
 ROMANIA                   |   1998 |  272784355.26053
 ROMANIA                   |   1997 | 463361149.425902
 ROMANIA                   |   1996 | 471663659.008936
 ROMANIA                   |   1995 | 465988127.268956
 ROMANIA                   |   1994 | 462220354.824003
 ROMANIA                   |   1993 | 457619575.764311
 ROMANIA                   |   1992 | 467409335.711921
 RUSSIA                    |   1998 | 277987984.707771
 RUSSIA                    |   1997 | 474885318.322796
 RUSSIA                    |   1996 | 482184629.486083
 RUSSIA                    |   1995 |  467300397.20337
 RUSSIA                    |   1994 | 476075573.439745
 RUSSIA                    |   1993 | 474194543.536019
 RUSSIA                    |   1992 | 467788314.010838
 SAUDI ARABIA              |   1998 | 278669154.208808
 SAUDI ARABIA              |   1997 | 472943097.181451
 SAUDI ARABIA              |   1996 | 481769962.689716
 SAUDI ARABIA              |   1995 | 474220648.249519
 SAUDI ARABIA              |   1994 | 473381460.078372
 SAUDI ARABIA              |   1993 | 473819419.977133
 SAUDI ARABIA              |   1992 | 473889137.904664
 UNITED KINGDOM            |   1998 | 270676605.954931
 UNITED KINGDOM            |   1997 |  461727705.78283
 UNITED KINGDOM            |   1996 | 470757746.428736
 UNITED KINGDOM            |   1995 | 471951424.411317
 UNITED KINGDOM            |   1994 | 470927932.283657
 UNITED KINGDOM            |   1993 | 471422874.382003
 UNITED KINGDOM            |   1992 | 468655511.881086
 UNITED STATES             |   1998 | 276931715.856723
 UNITED STATES             |   1997 | 473009726.393071
 UNITED STATES             |   1996 | 477420842.892797
 UNITED STATES             |   1995 |  476509985.92899
 UNITED STATES             |   1994 | 484635634.515351
 UNITED STATES             |   1993 | 473893439.179443
 UNITED STATES             |   1992 | 473926342.094551
 VIETNAM                   |   1998 | 276643577.017239
 VIETNAM                   |   1997 | 468620026.296336
 VIETNAM                   |   1996 | 469634206.402396
 VIETNAM                   |   1995 | 468257652.713733
 VIETNAM                   |   1994 | 464565426.129736
 VIETNAM                   |   1993 | 472716304.501588
 VIETNAM                   |   1992 | 470380793.465279
(175 rows)

COMMIT;
COMMIT
