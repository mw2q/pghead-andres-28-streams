BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%burlywood%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 265327508.387203
 ALGERIA                   |   1997 | 456814786.034661
 ALGERIA                   |   1996 | 454599164.629254
 ALGERIA                   |   1995 |  463325458.46444
 ALGERIA                   |   1994 | 452974796.273282
 ALGERIA                   |   1993 | 458874657.585668
 ALGERIA                   |   1992 | 455528850.954534
 ARGENTINA                 |   1998 | 268788804.823005
 ARGENTINA                 |   1997 | 464858888.393356
 ARGENTINA                 |   1996 | 462366161.498549
 ARGENTINA                 |   1995 | 469300697.335038
 ARGENTINA                 |   1994 | 464349038.114752
 ARGENTINA                 |   1993 | 468624379.567406
 ARGENTINA                 |   1992 | 458082066.619567
 BRAZIL                    |   1998 | 277853118.458678
 BRAZIL                    |   1997 | 469984971.446913
 BRAZIL                    |   1996 | 469257919.668067
 BRAZIL                    |   1995 | 474545156.339784
 BRAZIL                    |   1994 | 461325279.907402
 BRAZIL                    |   1993 | 471478418.805045
 BRAZIL                    |   1992 | 470922962.727821
 CANADA                    |   1998 | 276339154.811359
 CANADA                    |   1997 | 474709291.421837
 CANADA                    |   1996 |    475981070.779
 CANADA                    |   1995 | 482690095.728574
 CANADA                    |   1994 | 482715611.278791
 CANADA                    |   1993 |  473213497.36741
 CANADA                    |   1992 | 469563477.703511
 CHINA                     |   1998 |   270683976.1803
 CHINA                     |   1997 | 461863750.111845
 CHINA                     |   1996 | 469756386.810003
 CHINA                     |   1995 | 460318625.870563
 CHINA                     |   1994 | 465373071.855214
 CHINA                     |   1993 | 457524449.554674
 CHINA                     |   1992 | 458698713.876103
 EGYPT                     |   1998 | 265676981.393307
 EGYPT                     |   1997 | 466073024.740483
 EGYPT                     |   1996 | 462521691.099706
 EGYPT                     |   1995 | 451780819.906218
 EGYPT                     |   1994 | 460433619.890541
 EGYPT                     |   1993 | 457175499.280158
 EGYPT                     |   1992 | 460596062.513188
 ETHIOPIA                  |   1998 |  263796304.56714
 ETHIOPIA                  |   1997 | 455151156.469507
 ETHIOPIA                  |   1996 | 460449231.180246
 ETHIOPIA                  |   1995 | 459314478.030513
 ETHIOPIA                  |   1994 | 459085954.034128
 ETHIOPIA                  |   1993 | 463459746.703102
 ETHIOPIA                  |   1992 | 459361135.652936
 FRANCE                    |   1998 | 264346780.116478
 FRANCE                    |   1997 | 454405047.465999
 FRANCE                    |   1996 | 466595592.155789
 FRANCE                    |   1995 | 462741151.570257
 FRANCE                    |   1994 |  455124707.76211
 FRANCE                    |   1993 |  459131734.08559
 FRANCE                    |   1992 | 471205097.815409
 GERMANY                   |   1998 | 282310062.245718
 GERMANY                   |   1997 | 480611145.780585
 GERMANY                   |   1996 |  475481743.30601
 GERMANY                   |   1995 | 469055860.533486
 GERMANY                   |   1994 | 473403529.357712
 GERMANY                   |   1993 | 480235264.991958
 GERMANY                   |   1992 | 479320464.653879
 INDIA                     |   1998 | 277989336.288162
 INDIA                     |   1997 | 472797962.245746
 INDIA                     |   1996 | 479306519.633927
 INDIA                     |   1995 | 470872353.535046
 INDIA                     |   1994 | 477545835.104516
 INDIA                     |   1993 | 475988824.646195
 INDIA                     |   1992 | 471360612.314881
 INDONESIA                 |   1998 | 276885421.891512
 INDONESIA                 |   1997 | 462368981.111723
 INDONESIA                 |   1996 | 464263569.337678
 INDONESIA                 |   1995 | 465511073.186169
 INDONESIA                 |   1994 | 467407310.879394
 INDONESIA                 |   1993 | 460683906.453112
 INDONESIA                 |   1992 | 461479720.579882
 IRAN                      |   1998 |   270953478.2573
 IRAN                      |   1997 | 455386725.587918
 IRAN                      |   1996 | 448497452.980033
 IRAN                      |   1995 | 463291586.212024
 IRAN                      |   1994 |  455645017.95505
 IRAN                      |   1993 | 451104288.788603
 IRAN                      |   1992 | 460839706.242635
 IRAQ                      |   1998 | 275214579.299726
 IRAQ                      |   1997 | 472920927.855088
 IRAQ                      |   1996 | 470065978.181831
 IRAQ                      |   1995 | 472990911.619559
 IRAQ                      |   1994 | 474058884.332753
 IRAQ                      |   1993 | 471660045.037683
 IRAQ                      |   1992 |  471163491.40138
 JAPAN                     |   1998 | 274479769.064251
 JAPAN                     |   1997 | 466208220.714123
 JAPAN                     |   1996 | 471441221.872839
 JAPAN                     |   1995 |  463442451.58548
 JAPAN                     |   1994 | 473793017.074762
 JAPAN                     |   1993 | 469312039.478949
 JAPAN                     |   1992 | 462261478.938781
 JORDAN                    |   1998 | 270722624.252457
 JORDAN                    |   1997 | 460283651.732587
 JORDAN                    |   1996 | 457466022.053481
 JORDAN                    |   1995 |  461785086.34241
 JORDAN                    |   1994 | 458467077.019208
 JORDAN                    |   1993 | 467733157.931329
 JORDAN                    |   1992 | 461627662.132434
 KENYA                     |   1998 | 273010079.980994
 KENYA                     |   1997 | 470032819.082908
 KENYA                     |   1996 | 469421551.673038
 KENYA                     |   1995 | 471050814.095244
 KENYA                     |   1994 | 473059909.475441
 KENYA                     |   1993 | 470754334.382233
 KENYA                     |   1992 | 472592460.650413
 MOROCCO                   |   1998 | 279088717.716286
 MOROCCO                   |   1997 | 474990524.858835
 MOROCCO                   |   1996 |   477662886.6816
 MOROCCO                   |   1995 | 469362932.799601
 MOROCCO                   |   1994 | 473738216.933227
 MOROCCO                   |   1993 | 472567275.329475
 MOROCCO                   |   1992 | 476459798.838734
 MOZAMBIQUE                |   1998 | 275967858.127912
 MOZAMBIQUE                |   1997 | 464186263.033988
 MOZAMBIQUE                |   1996 | 458663941.821916
 MOZAMBIQUE                |   1995 | 463774112.530565
 MOZAMBIQUE                |   1994 | 455800002.008801
 MOZAMBIQUE                |   1993 | 456297061.948843
 MOZAMBIQUE                |   1992 | 462716878.224235
 PERU                      |   1998 | 264830703.005572
 PERU                      |   1997 | 461587394.364165
 PERU                      |   1996 | 463879723.452198
 PERU                      |   1995 | 455868538.729748
 PERU                      |   1994 | 456096438.831373
 PERU                      |   1993 | 449763669.990817
 PERU                      |   1992 | 452323779.073134
 ROMANIA                   |   1998 | 271284883.898972
 ROMANIA                   |   1997 | 463353749.324326
 ROMANIA                   |   1996 | 464557159.184592
 ROMANIA                   |   1995 | 464929706.277825
 ROMANIA                   |   1994 | 469852988.743356
 ROMANIA                   |   1993 | 463881752.742596
 ROMANIA                   |   1992 | 471575398.356043
 RUSSIA                    |   1998 | 274243521.389785
 RUSSIA                    |   1997 | 466899934.786359
 RUSSIA                    |   1996 | 464369288.364919
 RUSSIA                    |   1995 |  470021585.93756
 RUSSIA                    |   1994 | 464264678.656653
 RUSSIA                    |   1993 | 465455546.903506
 RUSSIA                    |   1992 |   469419712.8686
 SAUDI ARABIA              |   1998 | 277493306.513321
 SAUDI ARABIA              |   1997 | 461904178.807711
 SAUDI ARABIA              |   1996 | 461589317.452726
 SAUDI ARABIA              |   1995 | 465425071.929074
 SAUDI ARABIA              |   1994 | 463535357.069565
 SAUDI ARABIA              |   1993 | 462529052.965329
 SAUDI ARABIA              |   1992 | 462518308.425362
 UNITED KINGDOM            |   1998 | 266134917.629849
 UNITED KINGDOM            |   1997 | 456855829.969562
 UNITED KINGDOM            |   1996 | 454585190.896293
 UNITED KINGDOM            |   1995 | 457092147.650779
 UNITED KINGDOM            |   1994 | 449672080.530812
 UNITED KINGDOM            |   1993 | 451893019.083555
 UNITED KINGDOM            |   1992 | 454971857.768849
 UNITED STATES             |   1998 | 279228783.602337
 UNITED STATES             |   1997 | 473100801.633202
 UNITED STATES             |   1996 | 474799348.828751
 UNITED STATES             |   1995 | 474510817.378718
 UNITED STATES             |   1994 | 480378864.944826
 UNITED STATES             |   1993 | 475738109.625893
 UNITED STATES             |   1992 | 475263945.816267
 VIETNAM                   |   1998 |  275200983.55674
 VIETNAM                   |   1997 | 461322876.305175
 VIETNAM                   |   1996 | 470933533.565675
 VIETNAM                   |   1995 | 459874211.090659
 VIETNAM                   |   1994 | 465896806.762142
 VIETNAM                   |   1993 | 466269952.435013
 VIETNAM                   |   1992 | 469219484.670358
(175 rows)

COMMIT;
COMMIT
