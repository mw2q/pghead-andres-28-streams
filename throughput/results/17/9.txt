BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%honeydew%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 272011399.548468
 ALGERIA                   |   1997 | 458423992.271624
 ALGERIA                   |   1996 | 455706287.436411
 ALGERIA                   |   1995 | 463805780.726478
 ALGERIA                   |   1994 | 456116014.070773
 ALGERIA                   |   1993 | 466209225.182199
 ALGERIA                   |   1992 | 456647420.403763
 ARGENTINA                 |   1998 | 281897816.988842
 ARGENTINA                 |   1997 | 476444727.246909
 ARGENTINA                 |   1996 | 474211224.381417
 ARGENTINA                 |   1995 | 479057545.394002
 ARGENTINA                 |   1994 | 479700605.954444
 ARGENTINA                 |   1993 | 477196904.243385
 ARGENTINA                 |   1992 | 479804368.352842
 BRAZIL                    |   1998 |  274743589.04435
 BRAZIL                    |   1997 | 476139712.169851
 BRAZIL                    |   1996 | 471948701.314298
 BRAZIL                    |   1995 | 470490504.947257
 BRAZIL                    |   1994 | 480067458.502784
 BRAZIL                    |   1993 | 465905409.784325
 BRAZIL                    |   1992 | 473980811.771652
 CANADA                    |   1998 |  281360116.86714
 CANADA                    |   1997 | 476936825.768415
 CANADA                    |   1996 | 469685354.402113
 CANADA                    |   1995 | 475290673.569695
 CANADA                    |   1994 | 480012673.698082
 CANADA                    |   1993 | 470049002.258684
 CANADA                    |   1992 | 470915166.027789
 CHINA                     |   1998 | 274096290.651781
 CHINA                     |   1997 | 467207242.099414
 CHINA                     |   1996 | 475571818.755916
 CHINA                     |   1995 | 469907088.825251
 CHINA                     |   1994 | 475444789.994731
 CHINA                     |   1993 | 468069870.935493
 CHINA                     |   1992 | 478490675.325376
 EGYPT                     |   1998 | 271934702.086062
 EGYPT                     |   1997 |  471714497.68758
 EGYPT                     |   1996 |  474258609.82315
 EGYPT                     |   1995 | 459452706.200795
 EGYPT                     |   1994 | 461498778.436442
 EGYPT                     |   1993 | 466640498.389373
 EGYPT                     |   1992 | 464826538.586584
 ETHIOPIA                  |   1998 | 276841221.754636
 ETHIOPIA                  |   1997 | 464840829.316382
 ETHIOPIA                  |   1996 |  464575787.60165
 ETHIOPIA                  |   1995 | 469354763.882493
 ETHIOPIA                  |   1994 | 468109437.432368
 ETHIOPIA                  |   1993 | 467750253.615751
 ETHIOPIA                  |   1992 | 466653494.278382
 FRANCE                    |   1998 | 264554091.694204
 FRANCE                    |   1997 | 453969043.079491
 FRANCE                    |   1996 | 456827255.670566
 FRANCE                    |   1995 | 454022934.470968
 FRANCE                    |   1994 |  451102034.25089
 FRANCE                    |   1993 | 452789349.605742
 FRANCE                    |   1992 | 456324568.243075
 GERMANY                   |   1998 | 282230603.695565
 GERMANY                   |   1997 | 477257836.933692
 GERMANY                   |   1996 | 478034967.696038
 GERMANY                   |   1995 | 485819338.845762
 GERMANY                   |   1994 | 477033333.617093
 GERMANY                   |   1993 | 474865557.753138
 GERMANY                   |   1992 | 480312602.517867
 INDIA                     |   1998 | 276833728.761956
 INDIA                     |   1997 | 472161759.490289
 INDIA                     |   1996 | 475081793.422789
 INDIA                     |   1995 | 475976100.567662
 INDIA                     |   1994 | 472148391.931364
 INDIA                     |   1993 | 468581669.982551
 INDIA                     |   1992 | 473548280.599314
 INDONESIA                 |   1998 | 272499706.736366
 INDONESIA                 |   1997 | 465261007.046205
 INDONESIA                 |   1996 | 465172460.792941
 INDONESIA                 |   1995 | 456142188.878418
 INDONESIA                 |   1994 | 465820406.507424
 INDONESIA                 |   1993 | 461778489.925782
 INDONESIA                 |   1992 |   463199731.4287
 IRAN                      |   1998 | 274355208.517144
 IRAN                      |   1997 | 471020924.691331
 IRAN                      |   1996 | 466110768.583205
 IRAN                      |   1995 | 462839062.807576
 IRAN                      |   1994 | 460887444.343005
 IRAN                      |   1993 |   469155209.3699
 IRAN                      |   1992 | 465359713.002909
 IRAQ                      |   1998 | 274370054.119742
 IRAQ                      |   1997 | 466118970.733634
 IRAQ                      |   1996 | 469895101.322956
 IRAQ                      |   1995 | 468103866.051019
 IRAQ                      |   1994 | 463416354.505324
 IRAQ                      |   1993 | 471162623.661971
 IRAQ                      |   1992 | 470104517.475506
 JAPAN                     |   1998 |  272375864.25925
 JAPAN                     |   1997 | 472432854.790315
 JAPAN                     |   1996 | 456144701.362187
 JAPAN                     |   1995 | 464005144.303341
 JAPAN                     |   1994 | 471075242.557948
 JAPAN                     |   1993 | 464219066.782365
 JAPAN                     |   1992 | 466454458.998955
 JORDAN                    |   1998 | 272651451.544666
 JORDAN                    |   1997 | 460738011.403397
 JORDAN                    |   1996 | 458388917.461417
 JORDAN                    |   1995 | 466788660.281898
 JORDAN                    |   1994 |  463840331.66127
 JORDAN                    |   1993 | 473688170.531175
 JORDAN                    |   1992 | 457383940.223944
 KENYA                     |   1998 | 276508984.054775
 KENYA                     |   1997 |  470734415.39002
 KENYA                     |   1996 | 470011627.928771
 KENYA                     |   1995 | 467473313.135215
 KENYA                     |   1994 | 469468647.710861
 KENYA                     |   1993 | 468689575.175522
 KENYA                     |   1992 | 470412743.113922
 MOROCCO                   |   1998 | 274156240.287673
 MOROCCO                   |   1997 | 469067573.752043
 MOROCCO                   |   1996 | 472110433.668827
 MOROCCO                   |   1995 | 473492494.362872
 MOROCCO                   |   1994 | 473187071.696528
 MOROCCO                   |   1993 | 473753360.680496
 MOROCCO                   |   1992 | 472849546.369565
 MOZAMBIQUE                |   1998 | 270047101.281097
 MOZAMBIQUE                |   1997 | 457159829.922725
 MOZAMBIQUE                |   1996 | 467576488.234495
 MOZAMBIQUE                |   1995 | 466237015.424186
 MOZAMBIQUE                |   1994 | 464230337.439394
 MOZAMBIQUE                |   1993 | 452306711.882177
 MOZAMBIQUE                |   1992 |  458206714.58303
 PERU                      |   1998 | 266093336.236242
 PERU                      |   1997 |  461149510.61407
 PERU                      |   1996 | 458547030.159945
 PERU                      |   1995 | 460589496.601557
 PERU                      |   1994 | 450645086.225215
 PERU                      |   1993 | 453959564.057264
 PERU                      |   1992 | 461263414.233043
 ROMANIA                   |   1998 | 282346831.180468
 ROMANIA                   |   1997 | 473465748.649885
 ROMANIA                   |   1996 | 475408587.024345
 ROMANIA                   |   1995 | 476245371.541468
 ROMANIA                   |   1994 | 475064249.788759
 ROMANIA                   |   1993 | 475645900.107481
 ROMANIA                   |   1992 | 471969849.822664
 RUSSIA                    |   1998 | 283759293.497447
 RUSSIA                    |   1997 |  480233096.76514
 RUSSIA                    |   1996 | 474985770.428795
 RUSSIA                    |   1995 | 480618345.233351
 RUSSIA                    |   1994 | 480206642.445938
 RUSSIA                    |   1993 | 477747409.187638
 RUSSIA                    |   1992 | 479271724.362142
 SAUDI ARABIA              |   1998 | 272542176.181379
 SAUDI ARABIA              |   1997 | 458977960.872812
 SAUDI ARABIA              |   1996 |  469495189.77002
 SAUDI ARABIA              |   1995 | 468809307.558909
 SAUDI ARABIA              |   1994 | 461376971.043914
 SAUDI ARABIA              |   1993 | 460179979.559518
 SAUDI ARABIA              |   1992 | 460110322.861269
 UNITED KINGDOM            |   1998 | 271214160.741113
 UNITED KINGDOM            |   1997 | 466468262.499664
 UNITED KINGDOM            |   1996 | 461037897.076163
 UNITED KINGDOM            |   1995 |  463917452.85118
 UNITED KINGDOM            |   1994 |  467965359.11151
 UNITED KINGDOM            |   1993 |  469621689.78488
 UNITED KINGDOM            |   1992 | 469336982.249876
 UNITED STATES             |   1998 | 277575123.515889
 UNITED STATES             |   1997 | 474322832.892272
 UNITED STATES             |   1996 |  473232728.71127
 UNITED STATES             |   1995 | 471840175.044425
 UNITED STATES             |   1994 |  481295406.64854
 UNITED STATES             |   1993 | 480451418.455808
 UNITED STATES             |   1992 |  475972349.09025
 VIETNAM                   |   1998 | 274658871.634947
 VIETNAM                   |   1997 |  468268718.17352
 VIETNAM                   |   1996 |  470622578.63269
 VIETNAM                   |   1995 | 466729994.562035
 VIETNAM                   |   1994 | 465322326.658168
 VIETNAM                   |   1993 | 466378841.017147
 VIETNAM                   |   1992 | 461558344.623204
(175 rows)

COMMIT;
COMMIT
