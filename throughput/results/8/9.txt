BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%wheat%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 267337839.477167
 ALGERIA                   |   1997 | 455366245.166579
 ALGERIA                   |   1996 | 452877193.944181
 ALGERIA                   |   1995 | 459739125.378478
 ALGERIA                   |   1994 | 451065084.729786
 ALGERIA                   |   1993 | 456948407.613739
 ALGERIA                   |   1992 | 457928929.002653
 ARGENTINA                 |   1998 | 272712988.237823
 ARGENTINA                 |   1997 | 474103915.905546
 ARGENTINA                 |   1996 | 470072419.146052
 ARGENTINA                 |   1995 | 467310231.021574
 ARGENTINA                 |   1994 |  475558087.59468
 ARGENTINA                 |   1993 |  467886839.39276
 ARGENTINA                 |   1992 | 475156803.089482
 BRAZIL                    |   1998 |   275095523.7962
 BRAZIL                    |   1997 | 467593557.104162
 BRAZIL                    |   1996 | 467294418.954101
 BRAZIL                    |   1995 | 466345343.856028
 BRAZIL                    |   1994 | 469440980.459868
 BRAZIL                    |   1993 | 464997180.634278
 BRAZIL                    |   1992 | 477765693.103945
 CANADA                    |   1998 | 281098437.517009
 CANADA                    |   1997 | 481726169.570302
 CANADA                    |   1996 | 478060414.452338
 CANADA                    |   1995 | 476031232.896633
 CANADA                    |   1994 | 485724762.371201
 CANADA                    |   1993 | 480103795.193307
 CANADA                    |   1992 |  477369107.34375
 CHINA                     |   1998 | 274315186.794371
 CHINA                     |   1997 | 468795743.184741
 CHINA                     |   1996 | 472069442.025072
 CHINA                     |   1995 | 456629339.828029
 CHINA                     |   1994 | 468898828.972277
 CHINA                     |   1993 | 474898283.358445
 CHINA                     |   1992 | 469428351.105742
 EGYPT                     |   1998 | 276710751.429429
 EGYPT                     |   1997 | 462303223.019086
 EGYPT                     |   1996 | 466754529.739249
 EGYPT                     |   1995 | 462804098.916237
 EGYPT                     |   1994 | 464400441.385374
 EGYPT                     |   1993 | 459535962.121023
 EGYPT                     |   1992 | 462832161.817801
 ETHIOPIA                  |   1998 | 263991734.269481
 ETHIOPIA                  |   1997 | 450867654.953322
 ETHIOPIA                  |   1996 | 453194977.204752
 ETHIOPIA                  |   1995 |  454359718.48575
 ETHIOPIA                  |   1994 | 459928046.397874
 ETHIOPIA                  |   1993 | 454139044.678424
 ETHIOPIA                  |   1992 | 453035062.538692
 FRANCE                    |   1998 | 269160562.209396
 FRANCE                    |   1997 | 454143195.665579
 FRANCE                    |   1996 | 459973120.324422
 FRANCE                    |   1995 | 466210674.524515
 FRANCE                    |   1994 | 453674593.989714
 FRANCE                    |   1993 | 459986934.169111
 FRANCE                    |   1992 |  459517444.76029
 GERMANY                   |   1998 | 278281458.938283
 GERMANY                   |   1997 | 473874624.616244
 GERMANY                   |   1996 | 472546414.438103
 GERMANY                   |   1995 | 468678102.733324
 GERMANY                   |   1994 | 471611299.768195
 GERMANY                   |   1993 | 473084545.817823
 GERMANY                   |   1992 | 467782848.613545
 INDIA                     |   1998 | 270849109.557272
 INDIA                     |   1997 | 468955720.726018
 INDIA                     |   1996 | 466707898.425619
 INDIA                     |   1995 | 464837473.901133
 INDIA                     |   1994 | 469885660.284456
 INDIA                     |   1993 | 464636007.123887
 INDIA                     |   1992 | 470701799.733326
 INDONESIA                 |   1998 |  268552504.92311
 INDONESIA                 |   1997 |  462948832.15382
 INDONESIA                 |   1996 | 458526336.616924
 INDONESIA                 |   1995 | 457622974.528642
 INDONESIA                 |   1994 | 463543460.509771
 INDONESIA                 |   1993 | 458671423.662229
 INDONESIA                 |   1992 |  459369347.82376
 IRAN                      |   1998 |  268359826.17829
 IRAN                      |   1997 | 446971326.430862
 IRAN                      |   1996 | 460598001.729927
 IRAN                      |   1995 | 454951034.485962
 IRAN                      |   1994 | 459499218.607046
 IRAN                      |   1993 | 454076180.375363
 IRAN                      |   1992 | 455562093.503399
 IRAQ                      |   1998 | 277107301.222957
 IRAQ                      |   1997 | 470440628.740593
 IRAQ                      |   1996 | 473217556.902174
 IRAQ                      |   1995 |  471734579.44268
 IRAQ                      |   1994 | 468702015.540218
 IRAQ                      |   1993 | 469283766.857965
 IRAQ                      |   1992 | 465225055.743738
 JAPAN                     |   1998 | 271502173.675301
 JAPAN                     |   1997 | 466374276.327796
 JAPAN                     |   1996 | 460929403.449091
 JAPAN                     |   1995 |   464131406.1333
 JAPAN                     |   1994 | 469834965.924382
 JAPAN                     |   1993 | 473910075.338489
 JAPAN                     |   1992 | 465670086.603705
 JORDAN                    |   1998 |  271283849.80422
 JORDAN                    |   1997 | 465286387.706777
 JORDAN                    |   1996 | 456169137.073273
 JORDAN                    |   1995 | 459031170.452168
 JORDAN                    |   1994 | 459480182.648644
 JORDAN                    |   1993 | 461662581.062715
 JORDAN                    |   1992 | 463488473.903282
 KENYA                     |   1998 | 272463744.313363
 KENYA                     |   1997 | 460804039.877156
 KENYA                     |   1996 | 467847176.677073
 KENYA                     |   1995 | 458956957.703775
 KENYA                     |   1994 | 460008812.203941
 KENYA                     |   1993 | 465786566.447561
 KENYA                     |   1992 | 464161840.897626
 MOROCCO                   |   1998 | 272660698.283164
 MOROCCO                   |   1997 | 466932425.490475
 MOROCCO                   |   1996 | 472585781.312881
 MOROCCO                   |   1995 | 469912539.003072
 MOROCCO                   |   1994 | 463733248.770984
 MOROCCO                   |   1993 | 469032971.889078
 MOROCCO                   |   1992 | 471129546.541856
 MOZAMBIQUE                |   1998 | 273600063.333329
 MOZAMBIQUE                |   1997 | 455560550.935883
 MOZAMBIQUE                |   1996 | 464681705.629378
 MOZAMBIQUE                |   1995 | 460197076.867151
 MOZAMBIQUE                |   1994 | 458412584.846558
 MOZAMBIQUE                |   1993 | 453904252.721745
 MOZAMBIQUE                |   1992 | 461081733.915893
 PERU                      |   1998 | 268451360.822636
 PERU                      |   1997 | 474474179.646265
 PERU                      |   1996 | 469948482.648518
 PERU                      |   1995 | 457982345.046632
 PERU                      |   1994 | 467492277.235024
 PERU                      |   1993 | 466835913.331966
 PERU                      |   1992 | 476350651.094165
 ROMANIA                   |   1998 | 272107165.210002
 ROMANIA                   |   1997 | 459103773.953911
 ROMANIA                   |   1996 | 466449874.806001
 ROMANIA                   |   1995 |   462367638.2474
 ROMANIA                   |   1994 | 457050107.222734
 ROMANIA                   |   1993 | 457429507.037618
 ROMANIA                   |   1992 | 460539489.690899
 RUSSIA                    |   1998 | 280801261.679751
 RUSSIA                    |   1997 | 467724279.837851
 RUSSIA                    |   1996 | 480256735.022643
 RUSSIA                    |   1995 | 471414763.128985
 RUSSIA                    |   1994 | 471424101.440436
 RUSSIA                    |   1993 | 466834878.828255
 RUSSIA                    |   1992 | 464941600.983853
 SAUDI ARABIA              |   1998 | 279337511.335995
 SAUDI ARABIA              |   1997 | 465106061.320562
 SAUDI ARABIA              |   1996 | 477036946.160281
 SAUDI ARABIA              |   1995 | 465172233.276655
 SAUDI ARABIA              |   1994 | 466159102.461403
 SAUDI ARABIA              |   1993 | 469018244.588292
 SAUDI ARABIA              |   1992 | 472734098.236319
 UNITED KINGDOM            |   1998 | 271168488.784251
 UNITED KINGDOM            |   1997 | 455787876.527186
 UNITED KINGDOM            |   1996 | 454103365.672056
 UNITED KINGDOM            |   1995 | 454283813.946926
 UNITED KINGDOM            |   1994 | 460655780.308532
 UNITED KINGDOM            |   1993 | 458150614.206038
 UNITED KINGDOM            |   1992 | 450925161.260458
 UNITED STATES             |   1998 | 274818948.192807
 UNITED STATES             |   1997 | 469276649.940085
 UNITED STATES             |   1996 | 462624503.264931
 UNITED STATES             |   1995 | 465232002.073857
 UNITED STATES             |   1994 | 472604975.806546
 UNITED STATES             |   1993 | 463017255.694532
 UNITED STATES             |   1992 | 467369586.310825
 VIETNAM                   |   1998 | 271025417.614718
 VIETNAM                   |   1997 | 457683365.813161
 VIETNAM                   |   1996 | 465923684.554302
 VIETNAM                   |   1995 |  463099949.21355
 VIETNAM                   |   1994 | 468528128.717746
 VIETNAM                   |   1993 | 466851750.625409
 VIETNAM                   |   1992 | 463317462.950705
(175 rows)

COMMIT;
COMMIT
