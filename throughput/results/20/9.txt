BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%cornflower%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264549077.306998
 ALGERIA                   |   1997 | 456930465.279743
 ALGERIA                   |   1996 | 463105885.797035
 ALGERIA                   |   1995 |  465555599.43323
 ALGERIA                   |   1994 | 452843638.965207
 ALGERIA                   |   1993 | 455836703.003401
 ALGERIA                   |   1992 | 466619126.059495
 ARGENTINA                 |   1998 | 275357441.348625
 ARGENTINA                 |   1997 | 462577633.484163
 ARGENTINA                 |   1996 | 465340368.134815
 ARGENTINA                 |   1995 | 470590030.491982
 ARGENTINA                 |   1994 | 467640429.822766
 ARGENTINA                 |   1993 | 461488259.021069
 ARGENTINA                 |   1992 | 459961237.200934
 BRAZIL                    |   1998 | 280310488.299055
 BRAZIL                    |   1997 | 473806095.427839
 BRAZIL                    |   1996 |  467805877.53744
 BRAZIL                    |   1995 |  466607277.64943
 BRAZIL                    |   1994 |  471479666.22865
 BRAZIL                    |   1993 | 466652320.058925
 BRAZIL                    |   1992 | 469332591.873512
 CANADA                    |   1998 | 280851215.427048
 CANADA                    |   1997 |   475131240.2222
 CANADA                    |   1996 | 477552801.079244
 CANADA                    |   1995 |  472875490.08971
 CANADA                    |   1994 | 490531898.003927
 CANADA                    |   1993 | 484300593.429077
 CANADA                    |   1992 | 481260623.422168
 CHINA                     |   1998 | 274111429.844491
 CHINA                     |   1997 | 469003952.589338
 CHINA                     |   1996 |  473228467.53213
 CHINA                     |   1995 | 469414684.942534
 CHINA                     |   1994 | 462192815.554167
 CHINA                     |   1993 | 464975426.741923
 CHINA                     |   1992 | 467360472.326228
 EGYPT                     |   1998 | 275112305.869098
 EGYPT                     |   1997 | 465725179.114057
 EGYPT                     |   1996 | 476897525.533695
 EGYPT                     |   1995 | 468644121.351807
 EGYPT                     |   1994 | 467574115.467864
 EGYPT                     |   1993 | 472345875.292888
 EGYPT                     |   1992 | 465387438.929072
 ETHIOPIA                  |   1998 | 265800019.128986
 ETHIOPIA                  |   1997 | 453480864.628709
 ETHIOPIA                  |   1996 | 455043383.846518
 ETHIOPIA                  |   1995 | 458689676.522577
 ETHIOPIA                  |   1994 |  456635575.91285
 ETHIOPIA                  |   1993 | 455659472.997537
 ETHIOPIA                  |   1992 | 461683157.789602
 FRANCE                    |   1998 | 271886349.719153
 FRANCE                    |   1997 | 455920337.698949
 FRANCE                    |   1996 | 470231658.220303
 FRANCE                    |   1995 | 455969814.182972
 FRANCE                    |   1994 |  461467910.36511
 FRANCE                    |   1993 | 467467785.616675
 FRANCE                    |   1992 | 462170950.312102
 GERMANY                   |   1998 | 284452319.304995
 GERMANY                   |   1997 | 485481320.679896
 GERMANY                   |   1996 | 486389277.762328
 GERMANY                   |   1995 | 488537781.222506
 GERMANY                   |   1994 | 492103877.456088
 GERMANY                   |   1993 | 483015520.653235
 GERMANY                   |   1992 | 484373209.005505
 INDIA                     |   1998 | 274863935.080005
 INDIA                     |   1997 | 475631082.942214
 INDIA                     |   1996 | 473876925.971177
 INDIA                     |   1995 | 470265437.129152
 INDIA                     |   1994 | 472983831.796838
 INDIA                     |   1993 | 464182451.533688
 INDIA                     |   1992 | 474623092.632073
 INDONESIA                 |   1998 | 269340973.670848
 INDONESIA                 |   1997 |  460786713.84131
 INDONESIA                 |   1996 | 466194039.411081
 INDONESIA                 |   1995 | 460965222.683574
 INDONESIA                 |   1994 | 457310770.834289
 INDONESIA                 |   1993 | 463113181.453758
 INDONESIA                 |   1992 |  457943193.23079
 IRAN                      |   1998 | 279215051.869808
 IRAN                      |   1997 | 467742850.306974
 IRAN                      |   1996 | 468208298.983672
 IRAN                      |   1995 | 474280792.707581
 IRAN                      |   1994 | 473326047.009432
 IRAN                      |   1993 | 463883671.492503
 IRAN                      |   1992 |  471841603.26215
 IRAQ                      |   1998 | 276621546.125009
 IRAQ                      |   1997 | 464404146.077409
 IRAQ                      |   1996 | 471868690.827573
 IRAQ                      |   1995 | 463828835.214701
 IRAQ                      |   1994 | 466847455.133423
 IRAQ                      |   1993 |  467032069.50726
 IRAQ                      |   1992 | 467238691.263152
 JAPAN                     |   1998 | 274012647.912112
 JAPAN                     |   1997 | 472959684.684119
 JAPAN                     |   1996 | 462582559.017953
 JAPAN                     |   1995 |  460554375.28633
 JAPAN                     |   1994 | 469283500.575978
 JAPAN                     |   1993 | 468128445.793479
 JAPAN                     |   1992 | 472902466.118933
 JORDAN                    |   1998 | 273251671.101614
 JORDAN                    |   1997 | 469921255.616043
 JORDAN                    |   1996 | 469399518.539546
 JORDAN                    |   1995 | 465989206.324831
 JORDAN                    |   1994 | 469254321.813809
 JORDAN                    |   1993 | 469082785.292626
 JORDAN                    |   1992 | 467157025.756499
 KENYA                     |   1998 | 278514568.687307
 KENYA                     |   1997 | 471124583.288657
 KENYA                     |   1996 | 473673842.632306
 KENYA                     |   1995 | 468039581.682017
 KENYA                     |   1994 | 473778062.243667
 KENYA                     |   1993 | 458652634.680067
 KENYA                     |   1992 |  466837208.79541
 MOROCCO                   |   1998 | 279918619.924866
 MOROCCO                   |   1997 |  474252861.50364
 MOROCCO                   |   1996 | 470641295.660944
 MOROCCO                   |   1995 | 469083766.241108
 MOROCCO                   |   1994 | 469115295.339925
 MOROCCO                   |   1993 | 463376304.210459
 MOROCCO                   |   1992 | 471332152.372588
 MOZAMBIQUE                |   1998 | 273273258.543278
 MOZAMBIQUE                |   1997 | 466282135.414367
 MOZAMBIQUE                |   1996 | 466599628.780249
 MOZAMBIQUE                |   1995 |   469658183.7613
 MOZAMBIQUE                |   1994 | 458674888.924318
 MOZAMBIQUE                |   1993 | 467679419.632481
 MOZAMBIQUE                |   1992 | 460243210.676915
 PERU                      |   1998 | 265993457.432478
 PERU                      |   1997 | 457610612.992543
 PERU                      |   1996 | 457029697.688492
 PERU                      |   1995 |  454946805.58067
 PERU                      |   1994 |     463374507.69
 PERU                      |   1993 |  465288838.10237
 PERU                      |   1992 | 457956211.963035
 ROMANIA                   |   1998 | 272661772.784749
 ROMANIA                   |   1997 | 465655252.232207
 ROMANIA                   |   1996 | 474910577.845018
 ROMANIA                   |   1995 | 467866017.423934
 ROMANIA                   |   1994 | 466913766.109059
 ROMANIA                   |   1993 | 467934995.339078
 ROMANIA                   |   1992 | 465447344.370146
 RUSSIA                    |   1998 | 272646738.791923
 RUSSIA                    |   1997 | 469608056.157555
 RUSSIA                    |   1996 | 467116627.023673
 RUSSIA                    |   1995 |  470502329.11327
 RUSSIA                    |   1994 | 468958179.892896
 RUSSIA                    |   1993 | 471338280.205524
 RUSSIA                    |   1992 | 466199762.219123
 SAUDI ARABIA              |   1998 | 275012411.434917
 SAUDI ARABIA              |   1997 | 468412532.299728
 SAUDI ARABIA              |   1996 | 466494831.434867
 SAUDI ARABIA              |   1995 | 472355706.583325
 SAUDI ARABIA              |   1994 | 465805394.280774
 SAUDI ARABIA              |   1993 | 474168797.622967
 SAUDI ARABIA              |   1992 | 467897913.618542
 UNITED KINGDOM            |   1998 | 270012869.508753
 UNITED KINGDOM            |   1997 |  454088193.73866
 UNITED KINGDOM            |   1996 | 461845860.967721
 UNITED KINGDOM            |   1995 | 453982324.106287
 UNITED KINGDOM            |   1994 |  450749344.68193
 UNITED KINGDOM            |   1993 | 452032353.273791
 UNITED KINGDOM            |   1992 | 463968151.074628
 UNITED STATES             |   1998 | 275906091.077852
 UNITED STATES             |   1997 | 481066998.975008
 UNITED STATES             |   1996 | 469920133.593836
 UNITED STATES             |   1995 | 473884877.608821
 UNITED STATES             |   1994 | 475974919.461258
 UNITED STATES             |   1993 | 484708891.901932
 UNITED STATES             |   1992 | 474037902.387094
 VIETNAM                   |   1998 | 269410766.806542
 VIETNAM                   |   1997 | 462856442.923107
 VIETNAM                   |   1996 | 469174442.577491
 VIETNAM                   |   1995 | 471960292.503504
 VIETNAM                   |   1994 | 466230161.490423
 VIETNAM                   |   1993 |  465482328.89656
 VIETNAM                   |   1992 | 465745362.530936
(175 rows)

COMMIT;
COMMIT
