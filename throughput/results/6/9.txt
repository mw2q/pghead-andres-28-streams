BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 270953037.441214
 ALGERIA                   |   1997 | 458976688.940545
 ALGERIA                   |   1996 | 465975537.349995
 ALGERIA                   |   1995 | 466089486.763971
 ALGERIA                   |   1994 | 459698873.164846
 ALGERIA                   |   1993 | 460540313.614949
 ALGERIA                   |   1992 | 463741631.593872
 ARGENTINA                 |   1998 | 272532966.473379
 ARGENTINA                 |   1997 | 468929211.054137
 ARGENTINA                 |   1996 |  467708758.38757
 ARGENTINA                 |   1995 | 471542042.119167
 ARGENTINA                 |   1994 | 462751573.208929
 ARGENTINA                 |   1993 | 467056636.921152
 ARGENTINA                 |   1992 | 465191175.274402
 BRAZIL                    |   1998 | 272035575.061512
 BRAZIL                    |   1997 | 460407809.725299
 BRAZIL                    |   1996 | 468953799.543805
 BRAZIL                    |   1995 | 469923557.721147
 BRAZIL                    |   1994 | 468833120.876171
 BRAZIL                    |   1993 | 462741372.682759
 BRAZIL                    |   1992 | 475179953.077733
 CANADA                    |   1998 | 281024697.475566
 CANADA                    |   1997 | 479166967.469362
 CANADA                    |   1996 | 473448848.944312
 CANADA                    |   1995 | 479875560.798681
 CANADA                    |   1994 | 487833309.366095
 CANADA                    |   1993 | 477046147.547625
 CANADA                    |   1992 | 473027118.227529
 CHINA                     |   1998 | 271014617.412757
 CHINA                     |   1997 | 454655618.419898
 CHINA                     |   1996 |   471789439.2683
 CHINA                     |   1995 | 469343147.338825
 CHINA                     |   1994 | 464674369.143767
 CHINA                     |   1993 |  466836144.49924
 CHINA                     |   1992 | 471628775.177484
 EGYPT                     |   1998 | 271193640.049285
 EGYPT                     |   1997 | 469503875.615514
 EGYPT                     |   1996 | 472795792.451933
 EGYPT                     |   1995 | 463076669.902738
 EGYPT                     |   1994 | 456459651.778657
 EGYPT                     |   1993 | 466548820.319582
 EGYPT                     |   1992 | 468850822.744608
 ETHIOPIA                  |   1998 | 264410719.974714
 ETHIOPIA                  |   1997 | 453595522.022615
 ETHIOPIA                  |   1996 | 450183101.693592
 ETHIOPIA                  |   1995 | 454051498.637411
 ETHIOPIA                  |   1994 | 455466959.756009
 ETHIOPIA                  |   1993 | 458541380.912935
 ETHIOPIA                  |   1992 | 458234497.081174
 FRANCE                    |   1998 | 273869734.036542
 FRANCE                    |   1997 |  464412699.35759
 FRANCE                    |   1996 | 465633081.611895
 FRANCE                    |   1995 | 458595267.529195
 FRANCE                    |   1994 | 459963093.981702
 FRANCE                    |   1993 | 461559714.453495
 FRANCE                    |   1992 | 461033672.829434
 GERMANY                   |   1998 | 279272065.834333
 GERMANY                   |   1997 | 477322593.276015
 GERMANY                   |   1996 | 475569122.411721
 GERMANY                   |   1995 | 464516521.609286
 GERMANY                   |   1994 | 481429021.139853
 GERMANY                   |   1993 |  474278526.70668
 GERMANY                   |   1992 | 479442455.367916
 INDIA                     |   1998 | 276368141.412235
 INDIA                     |   1997 | 465018592.488699
 INDIA                     |   1996 | 470879580.419052
 INDIA                     |   1995 | 475654582.219406
 INDIA                     |   1994 | 468620520.104915
 INDIA                     |   1993 | 468494982.717483
 INDIA                     |   1992 |  476893411.23136
 INDONESIA                 |   1998 | 275934010.204703
 INDONESIA                 |   1997 | 461177987.521605
 INDONESIA                 |   1996 | 465504230.935799
 INDONESIA                 |   1995 | 468225582.524454
 INDONESIA                 |   1994 |  463753703.53006
 INDONESIA                 |   1993 | 467961689.493164
 INDONESIA                 |   1992 | 458290768.138689
 IRAN                      |   1998 | 272041502.418103
 IRAN                      |   1997 | 464654840.674459
 IRAN                      |   1996 | 470254169.100663
 IRAN                      |   1995 | 470310814.937974
 IRAN                      |   1994 | 466702637.264211
 IRAN                      |   1993 | 463149610.517781
 IRAN                      |   1992 |  464930828.56786
 IRAQ                      |   1998 | 275386525.239785
 IRAQ                      |   1997 |  471311809.57465
 IRAQ                      |   1996 | 477034909.576266
 IRAQ                      |   1995 | 471524225.235369
 IRAQ                      |   1994 | 473928229.089941
 IRAQ                      |   1993 | 475546746.829265
 IRAQ                      |   1992 | 474096924.265474
 JAPAN                     |   1998 | 273676794.181137
 JAPAN                     |   1997 |  464147636.87759
 JAPAN                     |   1996 | 463372032.521046
 JAPAN                     |   1995 | 457443477.992284
 JAPAN                     |   1994 | 451546014.544364
 JAPAN                     |   1993 | 462613459.963797
 JAPAN                     |   1992 | 462822183.037461
 JORDAN                    |   1998 |  272822762.71289
 JORDAN                    |   1997 | 468309338.597211
 JORDAN                    |   1996 | 459788854.484262
 JORDAN                    |   1995 | 453246836.788659
 JORDAN                    |   1994 | 462097692.863576
 JORDAN                    |   1993 | 464779428.441313
 JORDAN                    |   1992 | 463048446.937211
 KENYA                     |   1998 | 270884482.962044
 KENYA                     |   1997 | 467540628.220062
 KENYA                     |   1996 | 471909346.391562
 KENYA                     |   1995 | 470942425.568775
 KENYA                     |   1994 | 473309631.904289
 KENYA                     |   1993 | 469087611.244097
 KENYA                     |   1992 |  474352260.53489
 MOROCCO                   |   1998 | 266228553.729514
 MOROCCO                   |   1997 | 468741888.174763
 MOROCCO                   |   1996 | 466449523.627032
 MOROCCO                   |   1995 | 462083219.822263
 MOROCCO                   |   1994 | 460263687.178845
 MOROCCO                   |   1993 | 465944862.901356
 MOROCCO                   |   1992 | 464663902.290805
 MOZAMBIQUE                |   1998 | 270865040.037308
 MOZAMBIQUE                |   1997 | 453582293.391519
 MOZAMBIQUE                |   1996 | 454668394.549275
 MOZAMBIQUE                |   1995 |  458754054.38362
 MOZAMBIQUE                |   1994 | 461872837.805977
 MOZAMBIQUE                |   1993 | 459081050.066877
 MOZAMBIQUE                |   1992 | 461494896.864037
 PERU                      |   1998 | 269043987.061693
 PERU                      |   1997 | 469714480.242299
 PERU                      |   1996 |  471640731.50385
 PERU                      |   1995 |  467391484.45113
 PERU                      |   1994 | 459946050.875523
 PERU                      |   1993 |  469981806.10998
 PERU                      |   1992 | 461498590.274918
 ROMANIA                   |   1998 | 275885725.831335
 ROMANIA                   |   1997 | 464632161.965684
 ROMANIA                   |   1996 | 471801248.653165
 ROMANIA                   |   1995 | 467328590.736004
 ROMANIA                   |   1994 | 465698453.447045
 ROMANIA                   |   1993 | 473388361.403952
 ROMANIA                   |   1992 | 471493231.068011
 RUSSIA                    |   1998 | 270529984.049512
 RUSSIA                    |   1997 | 464974891.915518
 RUSSIA                    |   1996 | 475517557.623556
 RUSSIA                    |   1995 | 466942992.889701
 RUSSIA                    |   1994 | 462961273.626298
 RUSSIA                    |   1993 | 468926866.137473
 RUSSIA                    |   1992 |   464543678.2873
 SAUDI ARABIA              |   1998 | 278567653.267146
 SAUDI ARABIA              |   1997 | 476018077.596134
 SAUDI ARABIA              |   1996 | 463242089.002165
 SAUDI ARABIA              |   1995 | 469098296.058881
 SAUDI ARABIA              |   1994 |  471793487.83873
 SAUDI ARABIA              |   1993 | 461030042.972952
 SAUDI ARABIA              |   1992 | 467696412.876563
 UNITED KINGDOM            |   1998 |  263413561.40362
 UNITED KINGDOM            |   1997 | 449824161.016549
 UNITED KINGDOM            |   1996 | 453840650.675972
 UNITED KINGDOM            |   1995 | 458619721.639993
 UNITED KINGDOM            |   1994 | 465268745.614806
 UNITED KINGDOM            |   1993 | 452337503.089994
 UNITED KINGDOM            |   1992 | 453561362.065402
 UNITED STATES             |   1998 | 266732781.697905
 UNITED STATES             |   1997 | 466782919.682584
 UNITED STATES             |   1996 | 462490069.567852
 UNITED STATES             |   1995 | 462931589.423502
 UNITED STATES             |   1994 | 463860132.397899
 UNITED STATES             |   1993 |   460584497.4387
 UNITED STATES             |   1992 | 460722992.510254
 VIETNAM                   |   1998 | 273195882.118459
 VIETNAM                   |   1997 | 462693541.791016
 VIETNAM                   |   1996 |  466194392.16602
 VIETNAM                   |   1995 | 467989730.273769
 VIETNAM                   |   1994 | 475574949.002533
 VIETNAM                   |   1993 | 466366925.373103
 VIETNAM                   |   1992 | 461891139.689982
(175 rows)

COMMIT;
COMMIT
